@(currentPage: io.ebean.PagedList[models.SoilDiagnostic],
    currentSortBy: String,
    currentOrder: String,
    currentFilter: String)(
    implicit request: Http.Request,
    messages: play.i18n.Messages)
@import utils.GlobalConfigHelper
@import helper._

@****************************************
* Helper generating navigation links    *
****************************************@
@link(newPage:Int, newSortBy:String) = @{

  var sortBy = currentSortBy
  var order = currentOrder

  if(newSortBy != null) {
    sortBy = newSortBy
    if(currentSortBy == newSortBy) {
      if(currentOrder == "asc") {
        order = "desc"
      } else {
        order = "asc"
      }
    } else {
      order = "asc"
    }
  }

  // Generate the link
  routes.SoilDiagnosticController.list(newPage, sortBy, order, currentFilter)

}

  @**********************************
  * Helper generating table headers *
  ***********************************@
@header(key:String, title:String) = {
  <th scope="col" class="@key.replace(".","_")">
    <a class="sort-link @if(currentSortBy != key) { sort-link-inactive }" href="@link(0, key)">@title @sortIcon(key)</a>
  </th>
}


@sortIcon(key:String) = {
@if(currentOrder == "asc") {
  <i class="fa fa-fw fa-caret-down"></i>
} else {
  <i class="fa fa-fw fa-caret-up"></i>
}

}

@main {

  <h1 class="my-3" id="page-title">@messages("soildiagnostics.management") (@currentPage.getTotalCount)</h1>

  @request.flash.asScala().get("success").map { successFlashValue =>
    <div class="alert alert-warning" role="alert">
      <strong>@messages("common.success")!</strong> @successFlashValue
    </div>
  }

  <div class="row">
    <div class="col-sm-6">
      <form class="form-inline" action="@link(0, "diagnosticDate")" method="GET">
        <div class="form-group mr-sm-2 mb-2">
          <label for="searchbox" class="sr-only">@messages("soildiagnostics.search.placeholder")</label>
          <input type="search" class="form-control" id="searchbox" name="f" value="@currentFilter" placeholder="@messages("soildiagnostics.search.placeholder")">
        </div>
        <button type="submit" id="searchsubmit" class="btn btn-primary mb-2">@messages("common.search")</button>
      </form>
    </div>
    <div class="col-sm-6">
      <a href="@routes.SoilDiagnosticController.create()" id="add" class="btn btn-success float-right" role="button">@messages("soildiagnostics.add.new")</a>
    </div>
  </div>

  @if(currentPage.getTotalCount == 0) {

    <div class="card card-body bg-light">
      <em>@messages("soildiagnostics.list.title", currentPage.getTotalCount)</em>
    </div>

  } else {

    <table class="table table-bordered table-striped table-hover">
      <thead class="thead-light">
        <tr>
          @header("diagnosticDate", messages("soildiagnostics.date"))
          @header("field.name", messages("soildiagnostics.field"))
          @header("phH2O", messages("soildiagnostics.ph.h2o"))
          @header("ec", messages("soildiagnostics.ec"))
          @header("cec", messages("soildiagnostics.cec"))
          <th scope="col">@messages("soildiagnostics.actions")</th>
        </tr>
      </thead>
      <tbody>

      @for(soilDiagnostic <- currentPage.getList.asScala) {
        <tr>
          <td><a href="@routes.SoilDiagnosticController.edit(soilDiagnostic.getId())">@soilDiagnostic.getDiagnosticDate()</a></td>
          <td>@if(soilDiagnostic.getField() != null) { @soilDiagnostic.getField().getName() } else { - }</td>
          <td>@if(soilDiagnostic.getPhH2O() != null) { @soilDiagnostic.getPhH2O() } else { - }</td>
          <td>@if(soilDiagnostic.getEc() != null) { @soilDiagnostic.getEc() } else { - }</td>
          <td>@if(soilDiagnostic.getCec() != null) { @soilDiagnostic.getCec() } else { - }</td>
          <td>
            <a href="@routes.SoilDiagnosticController.edit(soilDiagnostic.getId())" class="btn btn-sm btn-primary">@messages("soildiagnostics.edit")</a>
            <form style="display: inline;" method="POST" action="@routes.SoilDiagnosticController.delete(soilDiagnostic.getId())" onsubmit="return confirm('@messages("soildiagnostics.delete.confirm")');">
              @CSRF.formField
              <button type="submit" class="btn btn-sm btn-danger">@messages("soildiagnostics.delete")</button>
            </form>
          </td>
        </tr>
      }

      </tbody>
    </table>

    <nav aria-label="...">
      <ul class="pagination float-right">
        @if(currentPage.hasPrev) {
          <li class="page-item previous">
            <a class="page-link" href="@link(currentPage.getPageIndex - 1, null)">&larr; Previous</a>
          </li>
        } else {
          <li class="page-item previous disabled">
            <a class="page-link">&larr; Previous</a>
          </li>
        }
        <li class="page-item disabled" aria-current="page">
          <a class="page-link" href="#">Displaying @currentPage.getDisplayXtoYofZ(" to "," of ")</a>
        </li>
        @if(currentPage.hasNext) {
          <li class="page-item next">
            <a class="page-link" href="@link(currentPage.getPageIndex + 1, null)">Next &rarr;</a>
          </li>
        } else {
          <li class="page-item next disabled">
            <a class="page-link" >Next &rarr;</a>
          </li>
        }
      </ul>
    </nav>

  }
}